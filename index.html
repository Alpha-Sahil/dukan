<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dukan</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="main-container">
        <div class="main-inner-container">
            <div class="main-box" id="mainBox">
                <div class="heading">
                    <h1>
                        Welcome Sahil
                    </h1>
                </div>

                <div class="loader" id="loader"></div>
            </div>
        </div>
    </div>
    <script>
        fetch('./saman.json')
            .then((response) => response.json())
            .then((response) => {
                console.log(response.ballu)
                let currentCustomer = response.ballu

                let keys = Object.keys(response.ballu)

                let length = Object.keys(response.ballu).length;

                for(let i = 0; i < length; i++) {
                    let mainBox = document.getElementById('mainBox')

                    let mainSamanDiv = createMainBox(mainBox)

                    let dateDiv = createDateElement(mainSamanDiv, keys[i])

                    let containerTable = createSamanTable(mainSamanDiv)

                    createTableHeader(containerTable)

                    createTableRows(containerTable, currentCustomer[keys[i]])
                }

                let loader = document.getElementById('loader')

                loader.style.display = 'none'
            });

        function createMainBox(mainBox) {
            let mainSamanDiv = document.createElement('div');
                    
            mainSamanDiv.classList.add('main-saman');

            mainBox.appendChild(mainSamanDiv);
        
            return mainSamanDiv
        }

        function createDateElement(mainSamanDiv, date) {
            let dateDiv = document.createElement('div');

            dateDiv.classList.add('date')

            dateDiv.textContent = `Date: ${date}`;

            mainSamanDiv.appendChild(dateDiv);

            return dateDiv
        }

        function createSamanTable(mainSamanDiv) {
            let samanTableDiv = document.createElement('div');
                    
            samanTableDiv.classList.add('saman-table');

            mainSamanDiv.appendChild(samanTableDiv);

            let containerTable = document.createElement('table')

            containerTable.classList.add('container');

            samanTableDiv.appendChild(containerTable);

            return containerTable
        }

        function createTableHeader(containerTable) {
            let tableHead = document.createElement('thead')
            const tr = document.createElement('tr');
            const th1 = document.createElement('th');
            const th2 = document.createElement('th');
            const th3 = document.createElement('th');
            const h1_1 = document.createElement('h1');

            // h1_1.textContent = '#';

            // th1.appendChild(h1_1)

            const h1_2 = document.createElement('h1');

            h1_2.textContent = 'Name';

            th2.appendChild(h1_2)

            const h1_3 = document.createElement('h1');

            h1_3.textContent = 'Price';

            th3.appendChild(h1_3)

            // tr.appendChild(th1);
            tr.appendChild(th2);
            tr.appendChild(th3);

            tableHead.appendChild(tr);

            containerTable.appendChild(tableHead)
        }

        function createTableRows(containerTable, data) {
            const tbody = document.createElement('tbody');

            for(let j = 0; j < data.length; j++) {
                const tr = document.createElement('tr');

                // const td1 = document.createElement('td');

                // td1.textContent = j + 1;

                const td2 = document.createElement('td');

                td2.textContent = data[j].name;

                const td3 = document.createElement('td');

                td3.textContent = data[j].price;

                // tr.appendChild(td1);
                tr.appendChild(td2);
                tr.appendChild(td3);

                tbody.appendChild(tr);
            }

            const tr = document.createElement('tr');

            const td1 = document.createElement('td');

            td1.textContent = 'Total';

            const td2 = document.createElement('td');

            td2.classList.add('yellow-background')

            td2.textContent = data.reduce((accumulator, currentValue) => accumulator + parseInt(currentValue.price), 0);

            tr.appendChild(td1);
            tr.appendChild(td2);
            tbody.appendChild(tr);

            containerTable.appendChild(tbody)
        }
    </script>
</body>
</html>